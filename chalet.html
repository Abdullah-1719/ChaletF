<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>الجوهرة - Simple booking for family</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f8f9fa;
      color: #333;
      line-height: 1.5;
      padding: 20px;
    }

    .container {
      max-width: 400px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 8px;
      text-align: center;
    }

    .subtitle {
      color: #6c757d;
      text-align: center;
      margin-bottom: 32px;
      font-size: 0.9rem;
    }

    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .month-year {
      font-size: 1.2rem;
      font-weight: 600;
      color: #2c3e50;
    }

    .nav-buttons {
      display: flex;
      gap: 8px;
    }

    .nav-btn {
      background: #e9ecef;
      border: none;
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 0.85rem;
      color: #495057;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .nav-btn:hover {
      background: #dee2e6;
    }

    .instruction {
      color: #6c757d;
      font-size: 0.85rem;
      margin-bottom: 16px;
      text-align: center;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 4px;
      margin-bottom: 24px;
    }

    .day-header {
      text-align: center;
      font-size: 0.75rem;
      color: #6c757d;
      padding: 8px 4px;
      font-weight: 500;
    }

    .day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column; /* Changed to column to stack day number and name */
      border-radius: 8px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      padding: 2px; /* Added padding for better text spacing */
    }

    .day.empty {
      cursor: default;
    }

    .day.available {
      background: #d4edda;
      color: #155724;
    }

    .day.available:hover {
      background: #c3e6cb;
    }

    .day.reserved {
      background: #f8d7da;
      color: #721c24;
      cursor: not-allowed;
      font-size: 0.7rem; /* Smaller font size to fit name */
    }

    .day.selected {
      background: #28a745;
      color: white;
      border: 2px solid #20c997;
    }

    .day.past {
      background: #f8f9fa;
      color: #adb5bd;
      cursor: not-allowed;
    }

    .legend {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 24px;
      font-size: 0.85rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }

    .legend-available {
      background: #d4edda;
    }

    .legend-reserved {
      background: #f8d7da;
    }

    .reservation-btn {
      width: 100%;
      background: #2c3e50;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 16px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .reservation-btn:hover {
      background: #34495e;
    }

    .reservation-btn:disabled {
      background: #adb5bd;
      cursor: not-allowed;
    }

    /* Reservation management section */
    .reservations-section {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #e9ecef;
    }

    .reservations-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 16px;
      text-align: center;
    }

    .form-group {
      margin-bottom: 16px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 4px;
      font-weight: 500;
      color: #495057;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ced4da;
      border-radius: 6px;
      font-size: 1rem;
    }

    .form-group input:focus {
      outline: none;
      border-color: #28a745;
    }

    .reservation-item {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .reservation-info {
      flex: 1;
    }

    .reservation-date {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 4px;
    }

    .reservation-name {
      color: #6c757d;
      font-size: 0.9rem;
    }

    .reservation-actions {
      display: flex;
      gap: 8px;
    }

    .action-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .edit-btn {
      background: #17a2b8;
      color: white;
    }

    .edit-btn:hover {
      background: #138496;
    }

    .cancel-btn {
      background: #dc3545;
      color: white;
    }

    .cancel-btn:hover {
      background: #c82333;
    }

    .no-reservations {
      text-align: center;
      color: #6c757d;
      font-style: italic;
      padding: 20px;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
    }

    .modal-content {
      background: white;
      margin: 20% auto;
      padding: 24px;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }

    .modal h3 {
      margin-bottom: 16px;
      color: #2c3e50;
    }

    .form-group {
      margin-bottom: 16px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 4px;
      font-weight: 500;
      color: #495057;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ced4da;
      border-radius: 6px;
      font-size: 1rem;
    }

    .form-group input:focus {
      outline: none;
      border-color: #28a745;
    }

    .modal-buttons {
      display: flex;
      gap: 12px;
      margin-top: 20px;
    }

    .btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .btn-primary {
      background: #28a745;
      color: white;
    }

    .btn-primary:hover {
      background: #218838;
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }

    /* Added styles for reserver name in date box */
    .reserver-name {
      font-size: 0.6rem;
      font-weight: 500;
      line-height: 1;
      text-align: center;
      margin-top: 1px;
      word-break: break-word;
      max-width: 100%;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>الجوهرة</h1>
    <p class="subtitle">Simple booking for family</p>
    
    <div class="calendar-header">
      <div class="month-year" id="monthYear">August 2025</div>
      <div class="nav-buttons">
        <button class="nav-btn" id="prevBtn">Prev</button>
        <button class="nav-btn" id="todayBtn">Today</button>
        <button class="nav-btn" id="nextBtn">Next</button>
      </div>
    </div>
    
    <p class="instruction">Tap an <strong>Available</strong> day to pre-fill the reservation date.</p>
    
    <div class="calendar" id="calendar"></div>
    
    <div class="legend">
      <div class="legend-item">
        <div class="legend-color legend-available"></div>
        <span>Available</span>
      </div>
      <div class="legend-item">
        <div class="legend-color legend-reserved"></div>
        <span>Reserved</span>
      </div>
    </div>
    
    <button class="reservation-btn" id="makeReservationBtn">Make a Reservation</button>
    
    <!-- Reservation management section -->
    <div class="reservations-section" id="reservationsSection">
      <h3 class="reservations-title">Manage Your Reservations</h3>
      <!-- Added name lookup input field -->
      <div class="form-group">
        <label for="lookupName">Enter your name to view reservations:</label>
        <input type="text" id="lookupName" placeholder="Enter your name">
        <button class="btn btn-primary" id="lookupBtn" style="margin-top: 8px; width: 100%;">Find My Reservations</button>
      </div>
      <!-- Initially hidden reservations list -->
      <div id="reservationsList" style="display: none;"></div>
      <div id="noReservationsFound" class="no-reservations" style="display: none;">
        No reservations found for this name.
      </div>
    </div>
  </div>

  <!-- Reservation Modal -->
  <div class="modal" id="reservationModal">
    <div class="modal-content">
      <h3 id="modalTitle">Make a Reservation</h3>
      <form id="reservationForm">
        <div class="form-group">
          <label for="guestName">Name</label>
          <input type="text" id="guestName" required>
        </div>
        <div class="form-group">
          <label for="reservationDate">Date</label>
          <input type="date" id="reservationDate" required>
        </div>
        <div class="modal-buttons">
          <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
          <button type="submit" class="btn btn-primary" id="submitBtn">Book Now</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let reservations = {
      '2025-08-23': { name: 'أحمد' }
    };
    let currentDate = new Date(2025, 7, 1); // August 2025
    let selectedDate = null;
    let editingReservation = null;
    let currentLookupName = null;

    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
      'July', 'August', 'September', 'October', 'November', 'December'];
    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

    function formatDate(date) {
      return date.toISOString().split('T')[0];
    }

    function buildCalendar() {
      const calendar = document.getElementById('calendar');
      const monthYear = document.getElementById('monthYear');
      
      calendar.innerHTML = '';
      monthYear.textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;

      // Add day headers
      dayNames.forEach(day => {
        const dayHeader = document.createElement('div');
        dayHeader.className = 'day-header';
        dayHeader.textContent = day;
        calendar.appendChild(dayHeader);
      });

      const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
      const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
      const today = new Date();
      
      // Add empty cells for days before month starts
      for (let i = 0; i < firstDay.getDay(); i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'day empty';
        calendar.appendChild(emptyDay);
      }

      // Add days of the month
      for (let day = 1; day <= lastDay.getDate(); day++) {
        const dayElement = document.createElement('div');
        dayElement.className = 'day';
        
        const dayDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
        const dateString = formatDate(dayDate);
        
        if (dayDate < today) {
          dayElement.classList.add('past');
          dayElement.textContent = day;
        } else if (reservations[dateString]) {
          dayElement.classList.add('reserved');
          dayElement.innerHTML = `
            <div>${day}</div>
            <div class="reserver-name">${reservations[dateString].name}</div>
          `;
        } else {
          dayElement.classList.add('available');
          dayElement.textContent = day;
          dayElement.addEventListener('click', () => selectDate(dateString));
        }
        
        if (selectedDate === dateString) {
          dayElement.classList.add('selected');
        }
        
        calendar.appendChild(dayElement);
      }
    }

    function selectDate(dateString) {
      selectedDate = dateString;
      buildCalendar();
      document.getElementById('reservationDate').value = dateString;
    }

    function displayReservations(filterName = null) {
      const reservationsList = document.getElementById('reservationsList');
      const noReservationsFound = document.getElementById('noReservationsFound');
      
      if (!filterName) {
        reservationsList.style.display = 'none';
        noReservationsFound.style.display = 'none';
        return;
      }
      
      const filteredReservations = Object.entries(reservations)
        .filter(([date, reservation]) => 
          reservation.name.toLowerCase() === filterName.toLowerCase()
        );
      
      if (filteredReservations.length === 0) {
        reservationsList.style.display = 'none';
        noReservationsFound.style.display = 'block';
        return;
      }
      
      reservationsList.style.display = 'block';
      noReservationsFound.style.display = 'none';
      reservationsList.innerHTML = '';
      
      filteredReservations
        .sort(([dateA], [dateB]) => new Date(dateA) - new Date(dateB))
        .forEach(([date, reservation]) => {
          const reservationItem = document.createElement('div');
          reservationItem.className = 'reservation-item';
          
          const formattedDate = new Date(date).toLocaleDateString('en-US', {
            weekday: 'short',
            year: 'numeric',
            month: 'short',
            day: 'numeric'
          });
          
          reservationItem.innerHTML = `
            <div class="reservation-info">
              <div class="reservation-date">${formattedDate}</div>
              <div class="reservation-name">${reservation.name}</div>
            </div>
            <div class="reservation-actions">
              <button class="action-btn edit-btn" onclick="editReservation('${date}')">Edit</button>
              <button class="action-btn cancel-btn" onclick="cancelReservation('${date}')">Cancel</button>
            </div>
          `;
          
          reservationsList.appendChild(reservationItem);
        });
    }

    function editReservation(date) {
      editingReservation = date;
      const reservation = reservations[date];
      
      document.getElementById('modalTitle').textContent = 'Edit Reservation';
      document.getElementById('submitBtn').textContent = 'Update';
      document.getElementById('guestName').value = reservation.name;
      document.getElementById('reservationDate').value = date;
      
      showReservationModal();
    }

    function cancelReservation(date) {
      if (confirm('Are you sure you want to cancel this reservation?')) {
        delete reservations[date];
        buildCalendar();
        displayReservations(currentLookupName);
      }
    }

    function showReservationModal() {
      document.getElementById('reservationModal').style.display = 'block';
    }

    function hideReservationModal() {
      document.getElementById('reservationModal').style.display = 'none';
      editingReservation = null;
      document.getElementById('modalTitle').textContent = 'Make a Reservation';
      document.getElementById('submitBtn').textContent = 'Book Now';
    }

    // Event listeners
    document.getElementById('prevBtn').addEventListener('click', () => {
      currentDate.setMonth(currentDate.getMonth() - 1);
      buildCalendar();
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
      currentDate.setMonth(currentDate.getMonth() + 1);
      buildCalendar();
    });

    document.getElementById('todayBtn').addEventListener('click', () => {
      currentDate = new Date();
      selectedDate = null;
      buildCalendar();
    });

    document.getElementById('makeReservationBtn').addEventListener('click', showReservationModal);
    document.getElementById('cancelBtn').addEventListener('click', hideReservationModal);

    document.getElementById('reservationForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('guestName').value;
      const date = document.getElementById('reservationDate').value;
      
      if (editingReservation) {
        // Editing existing reservation
        if (date !== editingReservation && reservations[date]) {
          alert('This date is already reserved!');
          return;
        }
        
        // Remove old reservation if date changed
        if (date !== editingReservation) {
          delete reservations[editingReservation];
        }
        
        reservations[date] = { name };
        alert('Reservation updated successfully!');
      } else {
        // Creating new reservation
        if (reservations[date]) {
          alert('This date is already reserved!');
          return;
        }
        
        reservations[date] = { name };
        alert('Reservation confirmed!');
      }
      
      selectedDate = null;
      buildCalendar();
      if (currentLookupName) {
        displayReservations(currentLookupName);
      }
      hideReservationModal();
      document.getElementById('reservationForm').reset();
    });

    document.getElementById('lookupBtn').addEventListener('click', () => {
      const lookupName = document.getElementById('lookupName').value.trim();
      if (!lookupName) {
        alert('Please enter your name');
        return;
      }
      currentLookupName = lookupName;
      displayReservations(lookupName);
    });

    document.getElementById('lookupName').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('lookupBtn').click();
      }
    });

    // Initialize calendar
    buildCalendar();
    // displayReservations();
  </script>
</body>
</html>
